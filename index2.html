<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>แบบทดสอบปรนัย</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            max-width: 900px;
            margin: 30px auto;
            background-color: #f9faff;
            color: #333;
            padding: 20px;
        }
        h2 {
            color: #004080;
            text-align: center;
            margin-bottom: 30px;
        }
        .question-container {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 25px;
        }
        .question h3 {
            color: #0059b3;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        .choices {
            list-style: none;
            padding: 0;
        }
        .choices li {
            margin-bottom: 8px;
        }
        .choices label {
            display: block;
            background: #e6f2ff;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .choices label:hover {
            background-color: #cce6ff;
        }
        input[type="radio"] {
            margin-right: 10px;
        }
        button {
            display: block;
            width: 100%;
            max-width: 300px;
            padding: 15px;
            font-size: 1.1rem;
            background-color: #007acc;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin: 20px auto 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        }
        button:hover {
            background-color: #005fa3;
        }
        #result {
            background-color: #d1ffd1;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
            font-size: 1.2rem;
            text-align: center;
            color: #005900;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(0,150,0,0.3);
            display: none;
        }
        .loading-text {
            text-align: center;
            font-style: italic;
            color: #666;
            margin-top: 50px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <h2>แบบทดสอบปรนัย: การขายประกันชีวิตและสุขภาพผ่านทางโทรศัพท์ (50 ข้อ)</h2>

    <div id="loading" class="loading-text">กำลังโหลดแบบทดสอบ...</div>

    <form id="quizForm" class="hidden"></form>

    <button id="submitBtn" class="hidden">ส่งคำตอบ</button>

    <div id="result"></div>
    
    <a href="index 3.html">
        <button style="margin-top: 20px;">กลับสู่หน้าหลัก</button>
    </a>

    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

        const supabaseUrl = 'https://wzwyotzzxycqfwercakh.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6d3lvdHp6eHljcWZ3ZXJjYWtoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwNTg3MTMsImV4cCI6MjA3MjYzNDcxM30.lgiAf9oBUqsaWGb3u_80wuoKAODQHE_lIBxpGumhrno';
        const supabase = createClient(supabaseUrl, supabaseKey);

        let currentUser = null;

        const { data: { user }, error } = await supabase.auth.getUser();
        if (user) {
            currentUser = user;
        }

            const questions = [
            { q: "1. ข้อใดคือเป้าหมายหลักของการขายประกันผ่านโทรศัพท์", a: "B", choices: ["สร้างความสัมพันธ์", "ปิดการขาย", "ให้ข้อมูลเท่านั้น", "สอบถามความสนใจ"] },
            { q: "2. สิ่งที่ควรทำเมื่อเริ่มโทรหาลูกค้าคืออะไร", a: "A", choices: ["แนะนำตัวและชื่อบริษัท", "ถามคำถามทันที", "อธิบายผลิตภัณฑ์เลย", "ถามถึงรายได้ลูกค้า"] },
            { q: "3. น้ำเสียงที่เหมาะสมในการโทรคือแบบใด", a: "D", choices: ["จริงจัง", "เร่งรีบ", "พูดเร็ว", "ชัดเจนและเป็นมิตร"] },
            { q: "4. ควรทำอย่างไรหากลูกค้าไม่เข้าใจเงื่อนไข", a: "A", choices: ["อธิบายด้วยภาษาง่าย", "ข้ามไป", "พูดเสียงเบา", "อ่านจากสคริปต์อย่างเดียว"] },
            { q: "5. ข้อใดคือพฤติกรรมที่ไม่เหมาะสมในการโทร", a: "A", choices: ["พูดแทรกลูกค้า", "ฟังลูกค้าก่อน", "อธิบายด้วยความชัดเจน", "ตั้งใจฟังคำถาม"] },
            { q: "6. หลักการพูดเพื่อโน้มน้าวใจลูกค้าคืออะไร", a: "D", choices: ["เสนอราคาเท่านั้น", "พูดเร็ว", "พูดคนเดียว", "ตั้งคำถามเปิด"] },
            { q: "7. จุดเด่นของประกันสุขภาพคืออะไร", a: "B", choices: ["ไม่มีเบี้ย", "ความคุ้มครองค่ารักษาพยาบาล", "รับผลตอบแทนสูง", "เหมือนเงินฝาก"] },
            { q: "8. การติดตามลูกค้าในกรณีไม่รับสายควรทำอย่างไร", a: "A", choices: ["โทรใหม่ตามเวลาที่เหมาะสม", "โทรติดๆ กันหลายครั้ง", "ส่งข้อความทันที", "เลิกติดต่อลูกค้า"] },
            { q: "9. ประโยชน์ของประกันสะสมทรัพย์คืออะไร", a: "B", choices: ["ไม่มีความแน่นอน", "เก็บออมและคุ้มครอง", "เสี่ยงสูง", "ใช้ได้กับผู้สูงอายุเท่านั้น"] },
            { q: "10. ข้อมูลใดควรแจ้งกับลูกค้า", a: "B", choices: ["ข้อมูลคู่แข่ง", "ชื่อบริษัท และข้อมูลผลิตภัณฑ์", "ความเห็นส่วนตัว", "ข้อมูลการเมือง"] },
            { q: "11. การยืนยันความเข้าใจของลูกค้าคือขั้นตอนไหน", a: "A", choices: ["ก่อนจบการนำเสนอ", "เริ่มต้นบทสนทนา", "หลังทักทาย", "หลังเสนอราคา"] },
            { q: "12. วัตถุประสงค์หลักของประกันสะสมทรัพย์คืออะไร", a: "D", choices: ["คุ้มครองสุขภาพ", "สร้างภาระ", "ไม่มีผลตอบแทน", "ลดหย่อนภาษี"] },
            { q: "13. สิ่งใดควรหลีกเลี่ยงในการพูดคุยกับลูกค้า", a: "A", choices: ["ข่มขู่", "ให้ข้อมูลครบถ้วน", "น้ำเสียงนุ่มนวล", "ฟังลูกค้า"] },
            { q: "14. การแสดงความใส่ใจต่อลูกค้าเป็นอย่างไร", a: "C", choices: ["พูดให้จบเร็ว", "ใช้คำศัพท์เฉพาะ", "ถามความต้องการของลูกค้า", "เสนอแต่แผนราคาแพง"] },
            { q: "15. ควรปิดการขายในจังหวะใด", a: "B", choices: ["เมื่อเริ่มโทร", "เมื่อลูกค้าเข้าใจและยินยอม", "หลังอธิบายบางส่วน", "เมื่อมีเวลาน้อย"] },
            { q: "16. ข้อใดไม่ใช่ข้อดีของการขายทางโทรศัพท์", a: "C", choices: ["ต้นทุนต่ำ", "เข้าถึงลูกค้าได้เร็ว", "เห็นหน้าลูกค้า", "ประหยัดเวลา"] },
            { q: "17. หากลูกค้าปฏิเสธควรทำอย่างไร", a: "D", choices: ["วางสายทันที", "เสนอแผนอื่นทันที", "ขอให้ซื้อเลย", "ฟังเหตุผลและตอบข้อโต้แย้งอย่างสุภาพ"] },
            { q: "18. สิ่งใดไม่ควรทำระหว่างพูดโทรศัพท์", a: "A", choices: ["เคี้ยวขณะพูด", "อยู่ในที่เงียบ", "ใช้หูฟัง", "พูดให้ชัดถ้อยชัดคำ"] },
            { q: "19. อะไรสื่อถึงความเป็นมืออาชีพ", a: "C", choices: ["พูดเร็ว", "อ่านสคริปต์เท่านั้น", "ปรับเนื้อหาให้เหมาะกับลูกค้า", "พูดแต่เรื่องราคา"] },
            { q: "20. ประกันสะสมทรัพย์เหมาะกับใคร", a: "B", choices: ["คนมีรายได้ต่ำ", "ผู้ที่ต้องการออมระยะยาวและมีความคุ้มครอง", "เด็กเล็ก", "ผู้สูงอายุที่ไม่มีรายได้"] },
            { q: "21. คำพูดเปิดการโทรควรเป็นอย่างไร", a: "A", choices: ["สุภาพและชัดเจน", "ดุดันและมั่นใจ", "พูดให้จบเร็ว", "อ่านตามบทพูดอย่างเดียว"] },
            { q: "22. หากลูกค้าบอกว่าไม่มีเวลา ควรทำอย่างไร", a: "C", choices: ["พูดต่อทันที", "ตื๊อให้จบ", "ขอนัดเวลาใหม่", "วางสายไปเลย"] },
            { q: "23. การเสนอประกันแบบเร่งรีบมีผลอย่างไร", a: "D", choices: ["ลูกค้าซื้อทันที", "เข้าใจง่าย", "รู้สึกประทับใจ", "อาจทำให้ลูกค้าไม่เชื่อมั่น"] },
            { q: "24. ควรใช้ถ้อยคำอย่างไรเมื่ออธิบายกรมธรรม์", a: "B", choices: ["ศัพท์เทคนิคมาก ๆ", "ภาษาง่าย ๆ เข้าใจง่าย", "ใช้คำยาว ๆ", "แค่บอกชื่อแผน"] },
            { q: "25. ประโยชน์ของเบี้ยประกันที่ลูกค้าจ่ายคืออะไร", a: "A", choices: ["เป็นค่าคุ้มครองและสะสมทรัพย์", "เป็นค่าปรับ", "ไม่มีประโยชน์", "จ่ายให้ตัวแทน"] },
            { q: "26. การจดบันทึกระหว่างสนทนาช่วยได้อย่างไร", a: "C", choices: ["ไม่จำเป็น", "เสียเวลา", "ติดตามลูกค้าได้ดีขึ้น", "ทำให้ลืม"] },
            { q: "27. แนวทางตอบข้อโต้แย้งของลูกค้าคืออะไร", a: "D", choices: ["หลีกเลี่ยงการตอบ", "พูดให้จบไว", "พูดวกไปวนมา", "ฟังและตอบด้วยเหตุผลที่ตรงประเด็น"] },
            { q: "28. เมื่อลูกค้าถามเรื่องภาษี ควรตอบอย่างไร", a: "B", choices: ["ไม่ต้องรู้หรอก", "สามารถลดหย่อนภาษีได้ตามเงื่อนไขของกรมสรรพากร", "ไม่เกี่ยวกับกรมธรรม์", "ขึ้นกับดวง"] },
            { q: "29. ทำไมต้องเก็บข้อมูลลูกค้าอย่างเป็นระบบ", a: "C", choices: ["เพื่อลืมง่าย", "เพื่อโทรซ้ำโดยไม่รู้ตัว", "เพื่อติดตามผลและบริการภายหลัง", "เพื่อให้ข้อมูลซ้ำ ๆ"] },
            { q: "30. การตั้งเป้าหมายในการขายมีความสำคัญอย่างไร", a: "A", choices: ["ช่วยวางแผนการทำงาน", "ไม่มีผล", "ทำให้เครียด", "ไม่จำเป็น"] },
            { q: "31. การใช้คำถามเปิดในการพูดคุยช่วยอย่างไร", a: "B", choices: ["ทำให้ลูกค้ารู้สึกกดดัน", "ทำให้รู้ความต้องการลูกค้า", "เสียเวลา", "ทำให้ลูกค้าโกรธ"] },
            { q: "32. การใช้ภาษาที่เข้าใจง่ายสำคัญอย่างไร", a: "A", choices: ["ทำให้ลูกค้าเข้าใจง่ายขึ้น", "ทำให้ลูกค้าสับสน", "ไม่มีความหมาย", "ทำให้ดูไม่เป็นมืออาชีพ"] },
            { q: "33. เมื่อไหร่ควรเริ่มอธิบายผลประโยชน์", a: "C", choices: ["ทันทีที่โทร", "เมื่อจบการพูด", "เมื่อเข้าใจความต้องการลูกค้า", "เมื่อหมดเวลาพูด"] },
            { q: "34. การฟังอย่างตั้งใจช่วยอะไร", a: "D", choices: ["ทำให้เสียงดังขึ้น", "ลดเวลาพูด", "ไม่สำคัญ", "เข้าใจลูกค้ามากขึ้น"] },
            { q: "35. วิธีจัดการกับคำถามยากของลูกค้าคืออะไร", a: "B", choices: ["ตอบไปก่อนโดยไม่คิด", "ขอเวลาตรวจสอบข้อมูล", "เลี่ยงไม่ตอบ", "วางสาย"] },
            { q: "36. การสร้างความน่าเชื่อถือทำได้โดยวิธีใด", a: "A", choices: ["แนะนำตัวอย่างชัดเจน", "พูดเร็ว", "ไม่สนใจลูกค้า", "พูดให้จบเร็ว"] },
            { q: "37. คำถามประเภทไหนช่วยให้ลูกค้าพูดมากขึ้น", a: "C", choices: ["คำถามปลายปิด", "คำถามใช่/ไม่ใช่", "คำถามเปิด", "คำถามเดี่ยว"] },
            { q: "38. การสรุปเนื้อหาในการพูดสำคัญอย่างไร", a: "D", choices: ["ไม่สำคัญ", "ทำให้เสียเวลา", "ทำให้ลูกค้าเบื่อ", "ช่วยให้เข้าใจตรงกัน"] },
            { q: "39. วิธีปฏิเสธลูกค้าอย่างสุภาพควรทำอย่างไร", a: "B", choices: ["ตัดบททันที", "แสดงความเข้าใจและขอบคุณ", "พูดเสียงดัง", "วางสายทันที"] },
            { q: "40. เมื่อปิดการขายแล้ว ควรทำอะไรต่อ", a: "C", choices: ["เลิกงานทันที", "ไม่ต้องติดต่อลูกค้าอีก", "ติดตามผลและบริการหลังการขาย", "เปลี่ยนสายงาน"] },
            { q: "41. ข้อใดเป็นประโยชน์ของประกันสุขภาพ", a: "B", choices: ["เพิ่มหนี้สิน", "ช่วยลดภาระค่ารักษาพยาบาล", "ไม่มีประโยชน์", "เพิ่มความเสี่ยง"] },
            { q: "42. การอธิบายแผนประกันควรเน้นจุดใด", a: "C", choices: ["ราคาเพียงอย่างเดียว", "คำพูดทางเทคนิค", "ผลประโยชน์และความคุ้มครอง", "ความยาวของกรมธรรม์"] },
            { q: "43. คำพูดที่ควรหลีกเลี่ยงในการโทรขายคืออะไร", a: "A", choices: ["คำหยาบ", "คำสุภาพ", "คำถามเปิด", "คำชม"] },
            { q: "44. การรับฟังความคิดเห็นลูกค้าช่วยอย่างไร", a: "D", choices: ["ทำให้เสียเวลา", "ลดความน่าเชื่อถือ", "ทำให้ลูกค้ารู้สึกไม่ดี", "สร้างความสัมพันธ์ที่ดี"] },
            { q: "45. เมื่อลูกค้าสนใจแต่ยังไม่ตัดสินใจ ควรทำอย่างไร", a: "B", choices: ["ยกเลิกการติดต่อ", "นัดหมายติดตาม", "บังคับให้ซื้อ", "พูดเรื่องอื่น"] },
            { q: "46. การใช้คำพูดที่ชัดเจนช่วยอะไร", a: "A", choices: ["ทำให้ลูกค้าเข้าใจง่าย", "ทำให้สับสน", "เพิ่มเวลาโทร", "ลดความน่าเชื่อถือ"] },
            { q: "47. การพูดคุยด้วยความสุภาพช่วยอะไร", a: "C", choices: ["ทำให้ลูกค้าโกรธ", "ทำให้เสียเวลา", "สร้างความประทับใจ", "ทำให้พูดน้อยลง"] },
            { q: "48. ควรตอบคำถามลูกค้าอย่างไรเมื่อไม่ทราบคำตอบ", a: "B", choices: ["ตอบมั่วไปก่อน", "ขอเวลาตรวจสอบและติดต่อกลับ", "หลีกเลี่ยงไม่ตอบ", "วางสาย"] },
            { q: "49. การทำความเข้าใจความต้องการลูกค้าช่วยอะไร", a: "D", choices: ["ทำให้เสียเวลา", "ทำให้ลูกค้าเบื่อ", "ไม่มีผล", "เสนอแผนที่ตรงกับลูกค้า"] },
            { q: "50. ข้อใดคือสิ่งที่ควรจดบันทึกหลังโทรหาลูกค้า", a: "C", choices: ["จำนวนเพื่อนของลูกค้า", "ที่อยู่บ้าน", "ความต้องการและข้อสงสัยของลูกค้า", "วันเกิดของตัวแทน"] }
            ];

            const quizForm = document.getElementById('quizForm');
            const submitBtn = document.getElementById('submitBtn');
            const loading = document.getElementById('loading');
            const resultDiv = document.getElementById('result');

            function renderQuiz() {
                loading.classList.add('hidden');
                quizForm.classList.remove('hidden');
                submitBtn.classList.remove('hidden');

                questions.forEach((q, index) => {
                    const container = document.createElement('div');
                    container.className = 'question-container';

                    const questionTitle = document.createElement('h3');
                    questionTitle.textContent = q.q;
                    container.appendChild(questionTitle);

                    const ul = document.createElement('ul');
                    ul.className = 'choices';

                    q.choices.forEach((choice, i) => {
                        const li = document.createElement('li');
                        const label = document.createElement('label');
                        const input = document.createElement('input');
                        input.type = 'radio';
                        input.name = `question-${index}`;
                        input.value = String.fromCharCode(65 + i);
                        label.appendChild(input);
                        label.appendChild(document.createTextNode(`${input.value}. ${choice}`));
                        li.appendChild(label);
                        ul.appendChild(li);
                    });

                    container.appendChild(ul);
                    quizForm.appendChild(container);
                });
            }

            renderQuiz();

            submitBtn.addEventListener('click', async () => {
                let score = 0;
                const answers = [];

                questions.forEach((q, index) => {
                    const selected = document.querySelector(`input[name="question-${index}"]:checked`);
                    const answer = selected ? selected.value : null;
                    answers.push(answer);
                    if (answer === q.a) score++;
                });

                const totalQuestions = questions.length;

                const { error } = await supabase
                    .from('quiz_results')
                    .insert([
                        {
                            user_id: currentUser?.id || null,
                            user_email: currentUser?.email || null,
                            score: score,
                            total_questions: totalQuestions,
                            answers: answers
                        }
                    ]);

                if (error) {
                    console.error('Error saving quiz result:', error);
                    resultDiv.textContent = 'เกิดข้อผิดพลาดในการบันทึกผล กรุณาลองใหม่';
                    resultDiv.style.backgroundColor = '#ffd1d1';
                    resultDiv.style.color = '#900';
                } else {
                    resultDiv.textContent = `คุณได้คะแนน ${score} จาก ${totalQuestions} ข้อ`;
                }

                resultDiv.style.display = 'block';
                submitBtn.disabled = true;
            });
    </script>
</body>
</html>
